/*!
 * baguetteBox.js
 * @author  feimosi
 * @version 1.8.2
 * @url https://github.com/feimosi/baguetteBox.js
 */
!function(root,factory){"use strict";"function"==typeof define&&define.amd?define(factory):"object"==typeof exports?module.exports=factory():root.baguetteBox=factory()}(this,(function(){"use strict";var leftArrow='<svg width="44" height="60"><polyline points="30 10 10 30 30 50" stroke="rgba(255,255,255,0.5)" stroke-width="4"stroke-linecap="butt" fill="none" stroke-linejoin="round"/></svg>',rightArrow='<svg width="44" height="60"><polyline points="14 10 34 30 14 50" stroke="rgba(255,255,255,0.5)" stroke-width="4"stroke-linecap="butt" fill="none" stroke-linejoin="round"/></svg>',closeX='<svg width="30" height="30"><g stroke="rgb(160,160,160)" stroke-width="4"><line x1="5" y1="5" x2="25" y2="25"/><line x1="5" y1="25" x2="25" y2="5"/></g></svg>',options={},defaults={captions:!0,fullScreen:!1,noScrollbars:!1,titleTag:!1,buttons:"auto",async:!1,preload:2,animation:"slideIn",afterShow:null,afterHide:null,onChange:null,overlayBackgroundColor:"#000"},supports={},overlay,slider,previousButton,nextButton,closeButton,currentGallery=[],currentIndex=0,touch={},touchFlag=!1,regex=/.+\.(gif|jpe?g|png|webp)/i,data={},imagesElements=[],documentLastFocus=null,overlayClickHandler=function(event){-1!==event.target.id.indexOf("baguette-img")&&hideOverlay()},previousButtonClickHandler=function(event){event.stopPropagation?event.stopPropagation():event.cancelBubble=!0,showPreviousImage()},nextButtonClickHandler=function(event){event.stopPropagation?event.stopPropagation():event.cancelBubble=!0,showNextImage()},closeButtonClickHandler=function(event){event.stopPropagation?event.stopPropagation():event.cancelBubble=!0,hideOverlay()},touchstartHandler=function(event){touch.count++,touch.count>1&&(touch.multitouch=!0),touch.startX=event.changedTouches[0].pageX,touch.startY=event.changedTouches[0].pageY},touchmoveHandler=function(event){if(!touchFlag&&!touch.multitouch){event.preventDefault?event.preventDefault():event.returnValue=!1;var touchEvent=event.touches[0]||event.changedTouches[0];touchEvent.pageX-touch.startX>40?(touchFlag=!0,showPreviousImage()):touchEvent.pageX-touch.startX<-40?(touchFlag=!0,showNextImage()):touch.startY-touchEvent.pageY>100&&hideOverlay()}},touchendHandler=function(){touch.count--,touch.count<=0&&(touch.multitouch=!1),touchFlag=!1},trapFocusInsideOverlay=function(event){"block"===overlay.style.display&&overlay.contains&&!overlay.contains(event.target)&&(event.stopPropagation(),initFocus())};function run(selector,userOptions){supports.transforms=testTransformsSupport(),supports.svg=testSVGSupport(),buildOverlay(),removeFromCache(selector),bindImageClickListeners(selector,userOptions)}function bindImageClickListeners(selector,userOptions){var galleryNodeList=document.querySelectorAll(selector),selectorData={galleries:[],nodeList:galleryNodeList};data[selector]=selectorData,[].forEach.call(galleryNodeList,(function(galleryElement){userOptions&&userOptions.filter&&(regex=userOptions.filter);var tagsNodeList=[];if(tagsNodeList="A"===galleryElement.tagName?[galleryElement]:galleryElement.getElementsByTagName("a"),0!==(tagsNodeList=[].filter.call(tagsNodeList,(function(element){return regex.test(element.href)}))).length){var gallery=[];[].forEach.call(tagsNodeList,(function(imageElement,imageIndex){var imageElementClickHandler=function(event){event.preventDefault?event.preventDefault():event.returnValue=!1,prepareOverlay(gallery,userOptions),showOverlay(imageIndex)},imageItem={eventHandler:imageElementClickHandler,imageElement:imageElement};bind(imageElement,"click",imageElementClickHandler),gallery.push(imageItem)})),selectorData.galleries.push(gallery)}}))}function clearCachedData(){for(var selector in data)data.hasOwnProperty(selector)&&removeFromCache(selector)}function removeFromCache(selector){if(data.hasOwnProperty(selector)){var galleries=data[selector].galleries;[].forEach.call(galleries,(function(gallery){[].forEach.call(gallery,(function(imageItem){unbind(imageItem.imageElement,"click",imageItem.eventHandler)})),currentGallery===gallery&&(currentGallery=[])})),delete data[selector]}}function buildOverlay(){if(overlay=getByID("baguetteBox-overlay"))return slider=getByID("baguetteBox-slider"),previousButton=getByID("previous-button"),nextButton=getByID("next-button"),void(closeButton=getByID("close-button"));(overlay=create("div")).setAttribute("role","dialog"),overlay.id="baguetteBox-overlay",document.getElementsByTagName("body")[0].appendChild(overlay),(slider=create("div")).id="baguetteBox-slider",overlay.appendChild(slider),(previousButton=create("button")).setAttribute("type","button"),previousButton.id="previous-button",previousButton.setAttribute("aria-label","Previous"),previousButton.innerHTML=supports.svg?leftArrow:"&lt;",overlay.appendChild(previousButton),(nextButton=create("button")).setAttribute("type","button"),nextButton.id="next-button",nextButton.setAttribute("aria-label","Next"),nextButton.innerHTML=supports.svg?rightArrow:"&gt;",overlay.appendChild(nextButton),(closeButton=create("button")).setAttribute("type","button"),closeButton.id="close-button",closeButton.setAttribute("aria-label","Close"),closeButton.innerHTML=supports.svg?closeX:"&times;",overlay.appendChild(closeButton),previousButton.className=nextButton.className=closeButton.className="baguetteBox-button",bindEvents()}function keyDownHandler(event){switch(event.keyCode){case 37:showPreviousImage();break;case 39:showNextImage();break;case 27:hideOverlay()}}function bindEvents(){bind(overlay,"click",overlayClickHandler),bind(previousButton,"click",previousButtonClickHandler),bind(nextButton,"click",nextButtonClickHandler),bind(closeButton,"click",closeButtonClickHandler),bind(overlay,"touchstart",touchstartHandler),bind(overlay,"touchmove",touchmoveHandler),bind(overlay,"touchend",touchendHandler),bind(document,"focus",trapFocusInsideOverlay,!0)}function unbindEvents(){unbind(overlay,"click",overlayClickHandler),unbind(previousButton,"click",previousButtonClickHandler),unbind(nextButton,"click",nextButtonClickHandler),unbind(closeButton,"click",closeButtonClickHandler),unbind(overlay,"touchstart",touchstartHandler),unbind(overlay,"touchmove",touchmoveHandler),unbind(overlay,"touchend",touchendHandler),unbind(document,"focus",trapFocusInsideOverlay,!0)}function prepareOverlay(gallery,userOptions){if(currentGallery!==gallery){for(currentGallery=gallery,setOptions(userOptions);slider.firstChild;)slider.removeChild(slider.firstChild);imagesElements.length=0;for(var imagesFiguresIds=[],imagesCaptionsIds=[],i=0,fullImage;i<gallery.length;i++)(fullImage=create("div")).className="full-image",fullImage.id="baguette-img-"+i,imagesElements.push(fullImage),imagesFiguresIds.push("baguetteBox-figure-"+i),imagesCaptionsIds.push("baguetteBox-figcaption-"+i),slider.appendChild(imagesElements[i]);overlay.setAttribute("aria-labelledby",imagesFiguresIds.join(" ")),overlay.setAttribute("aria-describedby",imagesCaptionsIds.join(" "))}}function setOptions(newOptions){for(var item in newOptions||(newOptions={}),defaults)options[item]=defaults[item],void 0!==newOptions[item]&&(options[item]=newOptions[item]);slider.style.transition=slider.style.webkitTransition="fadeIn"===options.animation?"opacity .4s ease":"slideIn"===options.animation?"":"none","auto"===options.buttons&&("ontouchstart"in window||1===currentGallery.length)&&(options.buttons=!1),previousButton.style.display=nextButton.style.display=options.buttons?"":"none";try{overlay.style.backgroundColor=options.overlayBackgroundColor}catch(e){}}function showOverlay(chosenImageIndex){options.noScrollbars&&(document.documentElement.style.overflowY="hidden",document.body.style.overflowY="scroll"),"block"!==overlay.style.display&&(bind(document,"keydown",keyDownHandler),touch={count:0,startX:null,startY:null},loadImage(currentIndex=chosenImageIndex,(function(){preloadNext(currentIndex),preloadPrev(currentIndex)})),updateOffset(),overlay.style.display="block",options.fullScreen&&enterFullScreen(),setTimeout((function(){overlay.className="visible",options.afterShow&&options.afterShow()}),50),options.onChange&&options.onChange(currentIndex,imagesElements.length),documentLastFocus=document.activeElement,initFocus())}function initFocus(){options.buttons?previousButton.focus():closeButton.focus()}function enterFullScreen(){overlay.requestFullscreen?overlay.requestFullscreen():overlay.webkitRequestFullscreen?overlay.webkitRequestFullscreen():overlay.mozRequestFullScreen&&overlay.mozRequestFullScreen()}function hideOverlay(){options.noScrollbars&&(document.documentElement.style.overflowY="auto",document.body.style.overflowY="auto"),"none"!==overlay.style.display&&(unbind(document,"keydown",keyDownHandler),overlay.className="",setTimeout((function(){overlay.style.display="none",options.afterHide&&options.afterHide()}),500),documentLastFocus.focus())}function loadImage(index,callback){var imageContainer=imagesElements[index],galleryItem=currentGallery[index];if(void 0!==imageContainer&&void 0!==galleryItem)if(imageContainer.getElementsByTagName("img")[0])callback&&callback();else{var imageElement=galleryItem.imageElement,thumbnailElement=imageElement.getElementsByTagName("img")[0],imageCaption="function"==typeof options.captions?options.captions.call(currentGallery,imageElement):imageElement.getAttribute("data-caption")||imageElement.title,imageSrc=getImageSrc(imageElement),figure=create("figure");if(figure.id="baguetteBox-figure-"+index,loading.begin(),options.captions&&imageCaption){var figcaption=create("figcaption");figcaption.id="baguetteBox-figcaption-"+index,figcaption.innerHTML=imageCaption,figure.appendChild(figcaption)}imageContainer.appendChild(figure);var image=create("img");if(image.onload=function(){loading.end(),!options.async&&callback&&callback()},-1!=imageSrc.indexOf("#")&&(imageSrc="//"+imageSrc.split("#")[1]),-1!=imageSrc.indexOf("?x-oss-process"))var imageSrc=imageSrc.substring(0,imageSrc.indexOf("?"));image.setAttribute("src",imageSrc),image.id="baguette-image",image.setAttribute("onclick",'document.getElementById("baguetteBox-overlay").style.display="none"'),image.setAttribute("onerror","this.src=base+'/assets/img/no-img.jpg'"),image.alt=thumbnailElement&&thumbnailElement.alt||"",options.titleTag&&imageCaption&&(image.title=imageCaption),figure.appendChild(image),options.async&&callback&&callback()}}function getImageSrc(image){var result=image.href;if(image.dataset){var srcs=[];for(var item in image.dataset)"at-"!==item.substring(0,3)||isNaN(item.substring(3))||(srcs[item.replace("at-","")]=image.dataset[item]);for(var keys=Object.keys(srcs).sort((function(a,b){return parseInt(a,10)<parseInt(b,10)?-1:1})),width=window.innerWidth*window.devicePixelRatio,i=0;i<keys.length-1&&keys[i]<width;)i++;result=srcs[keys[i]]||result}return result}function showNextImage(){var returnValue;return currentIndex<=imagesElements.length-2?(currentIndex++,updateOffset(),preloadNext(currentIndex),returnValue=!0):options.animation&&(slider.className="bounce-from-right",setTimeout((function(){slider.className=""}),400),returnValue=!1),options.onChange&&options.onChange(currentIndex,imagesElements.length),returnValue}function showPreviousImage(){var returnValue;return currentIndex>=1?(currentIndex--,updateOffset(),preloadPrev(currentIndex),returnValue=!0):options.animation&&(slider.className="bounce-from-left",setTimeout((function(){slider.className=""}),400),returnValue=!1),options.onChange&&options.onChange(currentIndex,imagesElements.length),returnValue}function updateOffset(){var offset=100*-currentIndex+"%";"fadeIn"===options.animation?(slider.style.opacity=0,setTimeout((function(){supports.transforms?slider.style.transform=slider.style.webkitTransform="translate3d("+offset+",0,0)":slider.style.left=offset,slider.style.opacity=1}),400)):supports.transforms?slider.style.transform=slider.style.webkitTransform="translate3d("+offset+",0,0)":slider.style.left=offset}function testTransformsSupport(){var div=create("div");return void 0!==div.style.perspective||void 0!==div.style.webkitPerspective}function testSVGSupport(){var div=create("div");return div.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(div.firstChild&&div.firstChild.namespaceURI)}function preloadNext(index){index-currentIndex>=options.preload||loadImage(index+1,(function(){preloadNext(index+1)}))}function preloadPrev(index){currentIndex-index>=options.preload||loadImage(index-1,(function(){preloadPrev(index-1)}))}function bind(element,event,callback,useCapture){element.addEventListener?element.addEventListener(event,callback,useCapture):element.attachEvent("on"+event,(function(event){(event=event||window.event).target=event.target||event.srcElement,callback(event)}))}function unbind(element,event,callback,useCapture){element.removeEventListener?element.removeEventListener(event,callback,useCapture):element.detachEvent("on"+event,callback)}function getByID(id){return document.getElementById(id)}function create(element){return document.createElement(element)}function destroyPlugin(){unbindEvents(),clearCachedData(),unbind(document,"keydown",keyDownHandler),document.getElementsByTagName("body")[0].removeChild(document.getElementById("baguetteBox-overlay")),data={},currentGallery=[],currentIndex=0}return([].forEach||(Array.prototype.forEach=function(callback,thisArg){for(var i=0;i<this.length;i++)callback.call(thisArg,this[i],i,this)}),[].filter||(Array.prototype.filter=function(a,b,c,d,e){for(c=this,d=[],e=0;e<c.length;e++)a.call(b,c[e],e,c)&&d.push(c[e]);return d}),{run:run,destroy:destroyPlugin,showNext:showNextImage,showPrevious:showPreviousImage})}));